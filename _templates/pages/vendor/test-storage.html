{% extends layout %}

{% load i18n %}

{% block title %}{% translate "Главная" %}{% endblock %}

{% block content %}

<!--begin::Row-->
<div class="row g-5 g-xl-10 mb-5 mb-xl-10">
    <div class="app-main flex-column flex-row-fluid" id="kt_app_main">
        <!--begin::Content wrapper-->
        <div class="d-flex flex-column flex-column-fluid">
            <!--begin::Toolbar-->
            <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
                <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
                </div>
            </div>
            <!--end::Toolbar-->
            <!--begin::Content-->
            <div id="kt_app_content" class="app-content flex-column-fluid">
                <!--begin::Content container-->
                <div id="kt_app_content_container" class="app-container container-xxl">
                    <!--begin::Form-->
                    <form action="#">
                        <!--begin::Card-->
                        <div class="card mb-7">
                            <!--begin::Card body-->
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-5">
                                    <div class="position-relative w-md-400px me-md-2">
                                        <i class="ki-duotone ki-magnifier fs-3 text-gray-500 position-absolute top-50 translate-middle ms-6">
                                            <span class="path1"></span>
                                            <span class="path2"></span>
                                        </i>
                                        <input type="text" class="form-control form-control-solid ps-10" name="search" value="" placeholder="Поиск" />
                                    </div>
                                    <a href="#" class="btn btn-primary er fs-6 px-8 py-4" data-bs-toggle="modal" data-bs-target="#kt_modal_new_storage">Добавить склад</a>
                                </div>
                                <!--end::Compact form-->
                                <!--begin::Advance form-->
                                <div class="collapse" id="kt_advanced_search_form">
                                    <!--begin::Separator-->
                                    <div class="separator separator-dashed mt-9 mb-6"></div>
                                    <!--end::Separator-->
                                    <!--begin::Row-->
                                    <div class="row g-8 mb-8">
                                        <!--begin::Col-->
                                        <div class="col-xxl-7">
                                            <label class="fs-6 form-label fw-bold text-dark">Tags</label>
                                            <input type="text" class="form-control form-control form-control-solid" name="tags" value="products, users, events" />
                                        </div>
                                        <!--end::Col-->
                                        <!--begin::Col-->
                                        <div class="col-xxl-5">
                                            <!--begin::Row-->
                                            <div class="row g-8">
                                                <!--begin::Col-->
                                                <div class="col-lg-6">
                                                    <label class="fs-6 form-label fw-bold text-dark">Team Type</label>
                                                    <!--begin::Select-->
                                                    <select class="form-select form-select-solid" data-control="select2" data-placeholder="In Progress" data-hide-search="true">
                                                        <option value=""></option>
                                                        <option value="1">Not started</option>
                                                        <option value="2" selected="selected">In Progress</option>
                                                        <option value="3">Done</option>
                                                    </select>
                                                    <!--end::Select-->
                                                </div>
                                                <!--end::Col-->
                                                <!--begin::Col-->
                                                <div class="col-lg-6">
                                                    <label class="fs-6 form-label fw-bold text-dark">Select Group</label>
                                                    <!--begin::Radio group-->
                                                    <div class="nav-group nav-group-fluid">
                                                        <!--begin::Option-->
                                                        <label>
                                                            <input type="radio" class="btn-check" name="type" value="has" checked="checked" />
                                                            <span class="btn btn-sm btn-color-muted btn-active btn-active-primary fw-bold px-4">All</span>
                                                        </label>
                                                        <!--end::Option-->
                                                        <!--begin::Option-->
                                                        <label>
                                                            <input type="radio" class="btn-check" name="type" value="users" />
                                                            <span class="btn btn-sm btn-color-muted btn-active btn-active-primary fw-bold px-4">Users</span>
                                                        </label>
                                                        <!--end::Option-->
                                                        <!--begin::Option-->
                                                        <label>
                                                            <input type="radio" class="btn-check" name="type" value="orders" />
                                                            <span class="btn btn-sm btn-color-muted btn-active btn-active-primary fw-bold px-4">Orders</span>
                                                        </label>
                                                        <!--end::Option-->
                                                    </div>
                                                    <!--end::Radio group-->
                                                </div>
                                                <!--end::Col-->
                                            </div>
                                            <!--end::Row-->
                                        </div>
                                        <!--end::Col-->
                                    </div>
                                    <!--end::Row-->
                                    <!--begin::Row-->
                                    <div class="row g-8">
                                        <!--begin::Col-->
                                        <div class="col-xxl-7">
                                            <!--begin::Row-->
                                            <div class="row g-8">
                                                <!--begin::Col-->
                                                <div class="col-lg-4">
                                                    <label class="fs-6 form-label fw-bold text-dark">Min. Amount</label>
                                                    <!--begin::Dialer-->
                                                    <div class="position-relative" data-kt-dialer="true" data-kt-dialer-min="1000" data-kt-dialer-max="50000" data-kt-dialer-step="1000" data-kt-dialer-prefix="$" data-kt-dialer-decimals="2">
                                                        <!--begin::Decrease control-->
                                                        <button type="button" class="btn btn-icon btn-active-color-gray-700 position-absolute translate-middle-y top-50 start-0" data-kt-dialer-control="decrease">
                                                            <i class="ki-duotone ki-minus-circle fs-1">
                                                                <span class="path1"></span>
                                                                <span class="path2"></span>
                                                            </i>
                                                        </button>
                                                        <!--end::Decrease control-->
                                                        <!--begin::Input control-->
                                                        <input type="text" class="form-control form-control-solid border-0 ps-12" data-kt-dialer-control="input" placeholder="Amount" name="manageBudget" readonly="readonly" value="$50" />
                                                        <!--end::Input control-->
                                                        <!--begin::Increase control-->
                                                        <button type="button" class="btn btn-icon btn-active-color-gray-700 position-absolute translate-middle-y top-50 end-0" data-kt-dialer-control="increase">
                                                            <i class="ki-duotone ki-plus-circle fs-1">
                                                                <span class="path1"></span>
                                                                <span class="path2"></span>
                                                            </i>
                                                        </button>
                                                        <!--end::Increase control-->
                                                    </div>
                                                    <!--end::Dialer-->
                                                </div>
                                                <!--end::Col-->
                                                <!--begin::Col-->
                                                <div class="col-lg-4">
                                                    <label class="fs-6 form-label fw-bold text-dark">Max. Amount</label>
                                                    <!--begin::Dialer-->
                                                    <div class="position-relative" data-kt-dialer="true" data-kt-dialer-min="1000" data-kt-dialer-max="50000" data-kt-dialer-step="1000" data-kt-dialer-prefix="$" data-kt-dialer-decimals="2">
                                                        <!--begin::Decrease control-->
                                                        <button type="button" class="btn btn-icon btn-active-color-gray-700 position-absolute translate-middle-y top-50 start-0" data-kt-dialer-control="decrease">
                                                            <i class="ki-duotone ki-minus-circle fs-1">
                                                                <span class="path1"></span>
                                                                <span class="path2"></span>
                                                            </i>
                                                        </button>
                                                        <!--end::Decrease control-->
                                                        <!--begin::Input control-->
                                                        <input type="text" class="form-control form-control-solid border-0 ps-12" data-kt-dialer-control="input" placeholder="Amount" name="manageBudget" readonly="readonly" value="$100" />
                                                        <!--end::Input control-->
                                                        <!--begin::Increase control-->
                                                        <button type="button" class="btn btn-icon btn-active-color-gray-700 position-absolute translate-middle-y top-50 end-0" data-kt-dialer-control="increase">
                                                            <i class="ki-duotone ki-plus-circle fs-1">
                                                                <span class="path1"></span>
                                                                <span class="path2"></span>
                                                            </i>
                                                        </button>
                                                        <!--end::Increase control-->
                                                    </div>
                                                    <!--end::Dialer-->
                                                </div>
                                                <!--end::Col-->
                                                <!--begin::Col-->
                                                <div class="col-lg-4">
                                                    <label class="fs-6 form-label fw-bold text-dark">Team Size</label>
                                                    <input type="text" class="form-control form-control form-control-solid" name="city" />
                                                </div>
                                                <!--end::Col-->
                                            </div>
                                            <!--end::Row-->
                                        </div>
                                        <!--end::Col-->
                                        <!--begin::Col-->
                                        <div class="col-xxl-5">
                                            <!--begin::Row-->
                                            <div class="row g-8">
                                                <!--begin::Col-->
                                                <div class="col-lg-6">
                                                    <label class="fs-6 form-label fw-bold text-dark">Category</label>
                                                    <!--begin::Select-->
                                                    <select class="form-select form-select-solid" data-control="select2" data-placeholder="In Progress" data-hide-search="true">
                                                        <option value=""></option>
                                                        <option value="1">Not started</option>
                                                        <option value="2" selected="selected">Select</option>
                                                        <option value="3">Done</option>
                                                    </select>
                                                    <!--end::Select-->
                                                </div>
                                                <!--end::Col-->
                                                <!--begin::Col-->
                                                <div class="col-lg-6">
                                                    <label class="fs-6 form-label fw-bold text-dark">Status</label>
                                                    <div class="form-check form-switch form-check-custom form-check-solid mt-1">
                                                        <input class="form-check-input" type="checkbox" value="" id="flexSwitchChecked" checked="checked" />
                                                        <label class="form-check-label" for="flexSwitchChecked">Active</label>
                                                    </div>
                                                </div>
                                                <!--end::Col-->
                                            </div>
                                            <!--end::Row-->
                                        </div>
                                        <!--end::Col-->
                                    </div>
                                    <!--end::Row-->
                                </div>
                                <!--end::Advance form-->
                            </div>
                            <!--end::Card body-->
                        </div>
                        <!--end::Card-->
                    </form>
                    <!--end::Form-->
                    <!--begin::Toolbar-->
                    <div class="d-flex flex-wrap flex-stack pb-7">
                        <!--begin::Title-->
                        <div class="d-flex flex-wrap align-items-center my-1">
                            <h3 class="fw-bold me-5 my-1">{{orders_len}} Найдено
                        </div>
                        <!--end::Title-->
                        <!--begin::Controls-->
                        <div class="d-flex flex-wrap my-1">
                            <!--begin::Tab nav-->
                            <ul class="nav nav-pills me-6 mb-2 mb-sm-0">
                                <li class="nav-item m-0">
                                    <a class="btn btn-sm btn-icon btn-light btn-color-muted btn-active-primary me-3 active" data-bs-toggle="tab" href="#kt_project_users_card_pane">
                                        <i class="ki-duotone ki-element-plus fs-2">
                                            <span class="path1"></span>
                                            <span class="path2"></span>
                                            <span class="path3"></span>
                                            <span class="path4"></span>
                                            <span class="path5"></span>
                                        </i>
                                    </a>
                                </li>
                                <li class="nav-item m-0">
                                    <a class="btn btn-sm btn-icon btn-light btn-color-muted btn-active-primary" data-bs-toggle="tab" href="#kt_project_users_table_pane">
                                        <i class="ki-duotone ki-row-horizontal fs-2">
                                            <span class="path1"></span>
                                            <span class="path2"></span>
                                        </i>
                                    </a>
                                </li>
                            </ul>
                            <!--end::Tab nav-->
                            <!--begin::Actions-->
                            <div class="d-flex my-0">
                                <!--begin::Select-->
                                <select name="status" data-control="select2" data-hide-search="true" data-placeholder="Filter" class="form-select form-select-sm border-body bg-body w-150px me-5">
                                    <option value="1">Надевние</option>
                                    <option value="2">Последняя неделя</option>
                                    <option value="3">Последний месяц</option>
                                    <option value="4">Последний год</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="tab-content">
                        <div class="modal fade" tabindex="1" id="add_type">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Добавить новый тип контакта</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <input type="text" id="newContactType" class="form-control" placeholder="Новый тип контакта">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                                        <button type="button" id="confirmAddContact" class="btn btn-primary">Добавить</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="kt_project_users_card_pane" class="tab-pane fade show active">
                            <div class="row g-6 g-xl-9">
                                {% for storage in storages %}
                                <div class="col-md-6 col-xxl-4">
                                    <div class="card-toolbar d-flex justify-content-end">
                                        <button class="btn btn-icon btn-color-gray-400 btn-active-color-primary" data-kt-menu-trigger="click" data-kt-menu-placement="left" data-kt-menu-overflow="true">
                                            <i class="ki-duotone ki-dots-square fs-1">
                                                <span class="path1"></span>
                                                <span class="path2"></span>
                                                <span class="path3"></span>
                                                <span class="path4"></span>
                                            </i>
                                        </button>
                                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-semibold w-200px" data-kt-menu="true" style="">
                                            <div class="menu-item px-4">
                                                <a href="{{storage.id}}/edit" class="menu-link px-3">Редактировать</a>
                                                <a href="#" class="menu-link px-3 delete-storage" data-storage-id="{{ storage.id }}">Удалить</a>
                                            </div>
                                        </div>
                                    </div>
                                    <a href="{{storage.id}}" class="card hover-elevate-up shadow-sm parent-hover" style="height: 90%;">
                                        <div class="card-body d-flex flex-center flex-column pt-12 p-9">
                                            <span class="ms-3 text-gray-700 parent-hover-primary fs-2 fw-bold">
                                                {{storage.name}}
                                            </span>
                                            <div class="fw-semibold text-gray-700 mb-6 fs-5">{{storage.address}}</div>
                                            <div class="fw-semibold text-gray-700 mb-6 fs-5">{{storage.schedule}}</div>
                                            {% if storage.contacts.all %}
                                            <div class="table-responsive">
                                                <table class="table table-row-bordered">
                                                    <thead>
                                                        <tr class="fw-bold fs-6 text-gray-800">
                                                            <th>Контакты</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for contact in storage.contacts.all %}
                                                        <tr>
                                                            <td>{{contact.type}}</td>
                                                            <td>{{contact.value}}</td>
                                                            <td>{{contact.description}}</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                            {% else %}
                                            {% endif %}                                            
                                        </div>
                                    </a>
                                </div>  
                                {% endfor %}
                            </div>
                            <!--end::Row-->
                            <!--begin::Pagination-->
                            <div class="d-flex flex-stack flex-wrap pt-10">
                                <ul class="pagination">
                                    {% if storages.has_previous %}
                                        <li class="page-item">
                                            <a href="?page={{ storages.previous_page_number }}" class="page-link">
                                                <i class="previous"></i>
                                            </a>
                                        </li>
                                    {% endif %}
                                    
                                    {% for page_num in storages.paginator.page_range %}
                                        <li class="page-item {% if page_num == storages.number %}active{% endif %}">
                                            <a href="?page={{ page_num }}" class="page-link">{{ page_num }}</a>
                                        </li>
                                    {% endfor %}
                                    
                                    {% if storages.has_next %}
                                        <li class="page-item">
                                            <a href="?page={{ storages.next_page_number }}" class="page-link">
                                                <i class="next"></i>
                                            </a>
                                        </li>
                                    {% endif %}
                                </ul>
                            </div>
                            <!--end::Pagination-->
                        </div>
                        <div id="kt_project_users_table_pane" class="tab-pane fade">
                            <!--begin::Card-->
                            <div class="card card-flush">
                                <!--begin::Card body-->
                                <div class="card-body pt-0">
                                    <!--begin::Table container-->
                                    <div class="table-responsive">
                                        <!--begin::Table-->
                                        <table id="storage_table" class="table table-row-bordered table-row-dashed gy-4 align-middle fw-bold">
                                            <thead class="fs-7 text-gray-400 text-uppercase">
                                                <tr>
                                                    <th class="min-w-250px">Название</th>
                                                    <th class="min-w-150px">Адрес</th>
                                                    <th class="min-w-90px">График работы</th>
                                                    <th class="min-w-50px text-end">Действия</th>
                                                </tr>
                                            </thead>
                                            <tbody class="fs-6">
                                            {% for storage in user.vendor.storages.all %}
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="d-flex flex-column justify-content-center">
                                                                <a href="" class="mb-1 text-gray-800 text-hover-primary">{{storage.name}}</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>{{storage.address}}</td>
                                                    <td>{{storage.schedule}}</td>
                                                    <td class="text-end">
                                                        <a href="{{storage.id}}" class="btn btn-light btn-sm">Перейти</a>
                                                        <a href="{{storage.id}}/edit" class="btn btn-light btn-sm">Редактировать</a>
                                                    </td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                        <!--end::Table-->
                                    </div>
                                    <!--end::Table container-->
                                </div>
                                <!--end::Card body-->
                            </div>
                            <!--end::Card-->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="kt_modal_new_storage" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-650px">
                    <!--begin::Modal content-->
                    <div class="modal-content rounded">
                        <!--begin::Modal header-->
                        <div class="modal-header pb-0 border-0 justify-content-end">
                            <!--begin::Close-->
                            <div class="btn btn-sm btn-icon btn-active-color-primary" data-bs-dismiss="modal">
                                <i class="ki-duotone ki-cross fs-1">
                                    <span class="path1"></span>
                                    <span class="path2"></span>
                                </i>
                            </div>
                        </div>
                        <div class="modal-body scroll-y px-10 px-lg-15 pt-0 pb-15">
                            <!--begin:Form-->
                            <form id="kt_modal_new_storage_form" class="form" action="#" data-kt-redirect="/vendor/storage/">
                                {% csrf_token %}
                                <!--begin::Heading-->
                                <div class="mb-13 text-center">
                                    <!--begin::Title-->
                                    <h1 class="mb-3">Добавить склад</h1>
                                    <!--end::Title-->
                                </div>
                                <div class="d-flex flex-column mb-8 fv-row">
                                    <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                        <span class="required">Название</span>
                                    </label>
                                    <input type="text" class="form-control form-control-solid" placeholder="Введите название склада" name="name" />
                                </div>
                                <div class="d-flex flex-column mb-8 fv-row">
                                    <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                        <span>Адрес</span>
                                    </label>
                                    <input type="text" class="form-control form-control-solid" placeholder="Введите адрес склада" name="address" />
                                </div>
                                <div class="d-flex flex-column mb-8 fv-row">
                                    <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                        <span>График работы</span>
                                    </label>
                                    <input type="text" class="form-control form-control-solid" placeholder="Введите график работы склада" name="schedule" />
                                </div>
                                <div class="" storage-contacts="auto-options">
                                    <!--begin::Label-->
                                    <label class="form-label">Контакты</label>
                                    <!--end::Label-->
                                    <!--begin::Repeater-->
                                    <div id="contact_options">
                                        <div class="form-group">
                                            <div data-repeater-list="contact_options" class="d-flex flex-column gap-3">
                                                <div data-repeater-item="" class="form-group d-flex flex-wrap align-items-center gap-5">
                                                    <div class="input-group pb-1">
                                                        <div class="w-300 w-md-150px">
                                                            <select class="form-select" name="type" data-placeholder="Выберите тип" storage-contacts="contact_option">
                                                                <option></option>
                                                                {% for contact in user.vendor.contacts.all %}
                                                                <option value="{{contact.value}}">{{contact.type}}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                        <button class="border border-secondary btn btn-icon btn-flex btn-light-primary" data-bs-toggle="modal" data-bs-target="#add_type" type="button">
                                                            <i class="ki-duotone ki-plus fs-4"></i>
                                                        </button>
                                                    </div>
                                                    <input type="text" class="form-control mw-100 w-150px" name="value" placeholder="Значение" />
                                                    <input type="text" class="form-control mw-100 w-150px" name="description" placeholder="Примечание" />
                                                
                                                    <button class="border border-secondary btn btn-icon btn-flex btn-light-danger" data-repeater-delete type="button">
                                                        <i class="ki-duotone ki-trash fs-5"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group mt-5">
                                            <button type="button" data-repeater-create="" class="btn btn-sm btn-light-primary">
                                            <i class="ki-duotone ki-plus fs-2"></i>Добавить еще контакт</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-10 fv-row" style="margin-top: 20px;">
                                    <label class="form-label" for="dropshipper">Люди склада</label>
                                    <select id="employees" name="employees" class="form-select mb-2" data-control="select2" data-placeholder="Выберите сотрудников" data-allow-clear="true" multiple="multiple">
                                        <option></option>
                                        {% for employee in user.vendor.employees.all %}
                                        <option value="{{employee.id}}">{{ employee.name }}</option>
                                        {% endfor %}
                                    </select>
                                    <span class="dropdown-wrapper" aria-hidden="true"></span>
                                    </span>
                                </div>
                                <div class="text-center">
                                    <button type="reset" id="kt_modal_new_storage_cancel" class="btn btn-light me-3">Отменить</button>
                                    <button type="submit" id="kt_modal_new_storage_submit" class="btn btn-primary">
                                        <span class="indicator-label">Сохранить</span>
                                        <span class="indicator-progress">Пожалуйста подождите
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
                                    </button>
                                </div>
                                <!--end::Actions-->
                            </form>
                            <!--end:Form-->

                        </div>
                        <!--end::Modal body-->
                    </div>
                    <!--end::Modal content-->
                </div>
                <!--end::Modal dialog-->
            </div>
            <!--end::Content-->
        </div>

    </div>
</div>
<!--end::Row-->

{% endblock content %}